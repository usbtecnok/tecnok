<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Cadastro — Motorista</title>
<style>
body{font-family:Arial,Helvetica,sans-serif;background:#f3f6fb;margin:0;padding:20px}
.card{max-width:700px;margin:20px auto;background:#fff;padding:20px;border-radius:8px;box-shadow:0 6px 18px rgba(0,0,0,.06)}
h2{margin-top:0}
input,select,button{width:100%;padding:10px;margin:8px 0;border-radius:6px;border:1px solid #ddd}
button{background:#0b7be0;color:#fff;border:0;cursor:pointer}
</style>
</head>
<body>
<div class="card">
  <h2>Cadastro do Motorista</h2>
  <p>Informações do veículo e documentos.</p>
  <input id="dname" placeholder="Nome completo">
  <input id="dphone" placeholder="Telefone">
  <input id="license" placeholder="CNH (número)">
  <input id="car" placeholder="Marca / Modelo">
  <input id="plate" placeholder="Placa">
  <button id="btnDriver">Criar Conta Motorista</button>
</div>

<script>
document.getElementById('btnDriver').addEventListener('click', async () => {
  const payload = {
    name: document.getElementById('dname').value.trim(),
    phone: document.getElementById('dphone').value.trim(),
    cnh: document.getElementById('license').value.trim(),
    car: document.getElementById('car').value.trim(),
    plate: document.getElementById('plate').value.trim()
  };
  if(!payload.name||!payload.phone||!payload.cnh){ alert('Preencha campos obrigatórios'); return; }

  try {
    const res = await fetch('/api/signup-driver', { method:'POST', headers:{'content-type':'application/json'}, body:JSON.stringify(payload) });
    if(res.ok){ alert('Motorista cadastrado!'); location.href='/public/ride.html'; }
    else { const txt = await res.text(); alert('Erro: '+txt); }
  } catch (err) {
    console.warn('Backend offline — salvando local para testes');
    const drivers = JSON.parse(localStorage.getItem('usb_drivers')||'[]');
    drivers.push(payload);
    localStorage.setItem('usb_drivers', JSON.stringify(drivers));
    alert('Cadastro motorista salvo localmente (modo teste).');
    location.href='/public/ride.html';
  }
});
</script>
</body>
</html>
